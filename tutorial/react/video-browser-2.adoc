:toc:
:imagesdir: images

ifdef::env-github[]
:tip-caption: :bulb:
:note-caption: :information_source:
:important-caption: :heavy_exclamation_mark:
:caution-caption: :fire:
:warning-caption: :warning:
endif::[]

== Divide application into components

We should spend some time to get our application properly divided into components. The goal is to get distinct and encapsulated code components that together becomes the complete video browser. How to decide on component architecture is of course an artform in itself, with many different ways to do it.

In our case it makes at least somewhat sense to divide the application as the red rectangles depict:

image::video-app-mockup-divided-to-components.png[mockup2,600]

The picture shows that we have a top most component (the largest rectangle) which holds a set of child components. We do already have this top component in place - `app.js`, or in JSX-lingo: `<App />`

Let's settle on these child components and names

[ditaa]
....
App
 |
 +-- SearchBar
 +-- VideoDetail
 +-- VideoList
        |
        +-- VideoListItem
....

[cols=2*,options=header]
|===
|Component
|Description

|App
|The aggregating top component

|SearchBar
|Component responsible for rendering the search bar and to keep track of input

|VideoDetail
|Contains code for displaying an embedded video player, together with title and description, of a user selected video.

|VideoList
|Shows a list of videos from search result

|VideoListItem
|A single video from search result. If user clicks this item, the video should be sent to VideoDetail component

|===

Given these components, let's create the files we need, one file per component.

[quote]
____
. Create a directory `my-app/src/components`
. Create `src/components/search-bar.js`
. Create `src/components/video-detail.js`
. Create `src/components/video-list.js`
. Create `src/components/video-list-item.js`
____

== SearchBar

The search bar component should render an input field, so start by adding a class based React component that returns a simple `<input/>`

[quote]
____
. In `search-bar.js`, create the search component
+
[source,javascript]
----
import React, {Component} from 'react';

class SearchBar extends Component {

    render() {
        return <input/>;
    }
}
----
____

We have created the component, but we also need to make visible for other components, so it could be imported.

[quote]
____
. Last in `search-bar.js`, add export statement
+
[source,javascript]
----
export default SearchBar;
----
____

Now let's flip back to `app.js` so we can import and use the <SearchBar/> component

[quote]
____
. In `sapp.js`, add export statement to SearchBar. Note that you must specify the relative path to the file, and ommit the ".js" prefix
+
[source,javascript]
----
import SearchBar from './components/search-bar';
----
+
. Replace the "Hello world" in return statment with the SearchBar tag instead
+
[source,javascript]
----
   render() {
       return <div>
           <SearchBar />
       </div>;
   }
----
+
Note the deliberate line break, it is an attempt to make it more readable and html-like. The indentation doesn't look good however, so a common best practice is to use proper parenthesis around the expression:
+
[source,javascript]
----
   render() {
       return (
           <div>
               <SearchBar/>
           </div>
       );
   }
----
____

Save the file and take look in the browser. What do you see?

=== Handle input events

You should now see a simple, unadorned, search bar in top left corner of the browser. Even though it is possible to enter text in the input, nothing more actually happens. We want to capture the content entered to use it as a search term.

To do this we should write a event handler function and pass it to the <input> onChange event.

[quote]
____
. In `search-bar.js`, add event handler function that logs search bar content to console on every key stroke
+
[source,javascript]
----
import React, {Component} from 'react';

class SearchBar extends Component {

    handleInputChange(event) {
        console.log(event.target.value);
    }

    render() {
        return <input/>;
    }
}

export default SearchBar;
----
+
. Pass event handler to element we want to monitor, more specifically it's `onChange` event
+
[source,javascript]
----
import React, {Component} from 'react';

class SearchBar extends Component {

    handleInputChange(event) {
        console.log(event.target.value);
    }

    render() {
        return <input onChange={this.handleInputChange}/>;
    }
}

export default SearchBar;
----
[NOTE]
Any input you make to search bar should now turn up in the console log

It is also possible to use the _condensed arrow function_ instead, this allows us to inline the function directly in the onChange event:

[source,javascript]
----
import React, {Component} from 'react';

class SearchBar extends Component {
    render() {
        return <input onChange={event => console.log(event.target.value)} />;
    }
}

export default SearchBar;
----
____
